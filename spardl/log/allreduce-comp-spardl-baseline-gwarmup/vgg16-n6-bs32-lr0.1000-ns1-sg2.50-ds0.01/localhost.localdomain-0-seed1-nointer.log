2025-05-23 11:47:55,772 [main_trainer.py:279] INFO Configurations: Namespace(batch_size=32, nsteps_update=1, nworkers=6, nwpernode=1, compression=True, compressor='spardl', sigma_scale=2.5, density=0.01, dataset='cifar10', dnn='vgg16', data_dir='./vgg_data', lr=0.1, max_epochs=121, pretrain=None)
2025-05-23 11:47:55,772 [main_trainer.py:281] INFO Interpreter: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 15:12:24) [GCC 11.2.0]
2025-05-23 11:47:59,403 [dl_trainer.py:280] INFO target_sparsities: [1.0]
2025-05-23 11:47:59,403 [dl_trainer.py:290] INFO num_batches_per_epoch: 260
2025-05-23 11:47:59,403 [main_trainer.py:81] INFO Broadcast parameters....
2025-05-23 11:48:00,024 [main_trainer.py:96] INFO Broadcast parameters finished....
2025-05-23 11:48:00,109 [allreducer.py:281] INFO density: 0.010000
2025-05-23 11:48:00,110 [allreducer.py:282] INFO threshold scale: 1.092000
2025-05-23 11:48:00,110 [allreducer.py:663] INFO groups: [['fc.bias', 'fc.weight', 'features.41.bias', 'features.41.weight', 'features.40.bias', 'features.40.weight', 'features.38.bias', 'features.38.weight', 'features.37.bias', 'features.37.weight', 'features.35.bias', 'features.35.weight', 'features.34.bias', 'features.34.weight', 'features.31.bias', 'features.31.weight', 'features.30.bias', 'features.30.weight', 'features.28.bias', 'features.28.weight', 'features.27.bias', 'features.27.weight', 'features.25.bias', 'features.25.weight', 'features.24.bias', 'features.24.weight', 'features.21.bias', 'features.21.weight', 'features.20.bias', 'features.20.weight', 'features.18.bias', 'features.18.weight', 'features.17.bias', 'features.17.weight', 'features.15.bias', 'features.15.weight', 'features.14.bias', 'features.14.weight', 'features.11.bias', 'features.11.weight', 'features.10.bias', 'features.10.weight', 'features.8.bias', 'features.8.weight', 'features.7.bias', 'features.7.weight', 'features.4.bias', 'features.4.weight', 'features.3.bias', 'features.3.weight', 'features.1.bias', 'features.1.weight', 'features.0.bias', 'features.0.weight']]
2025-05-23 11:48:00,111 [allreducer.py:664] INFO key_groupidx_maps: {'fc.bias': 0, 'fc.weight': 0, 'features.41.bias': 0, 'features.41.weight': 0, 'features.40.bias': 0, 'features.40.weight': 0, 'features.38.bias': 0, 'features.38.weight': 0, 'features.37.bias': 0, 'features.37.weight': 0, 'features.35.bias': 0, 'features.35.weight': 0, 'features.34.bias': 0, 'features.34.weight': 0, 'features.31.bias': 0, 'features.31.weight': 0, 'features.30.bias': 0, 'features.30.weight': 0, 'features.28.bias': 0, 'features.28.weight': 0, 'features.27.bias': 0, 'features.27.weight': 0, 'features.25.bias': 0, 'features.25.weight': 0, 'features.24.bias': 0, 'features.24.weight': 0, 'features.21.bias': 0, 'features.21.weight': 0, 'features.20.bias': 0, 'features.20.weight': 0, 'features.18.bias': 0, 'features.18.weight': 0, 'features.17.bias': 0, 'features.17.weight': 0, 'features.15.bias': 0, 'features.15.weight': 0, 'features.14.bias': 0, 'features.14.weight': 0, 'features.11.bias': 0, 'features.11.weight': 0, 'features.10.bias': 0, 'features.10.weight': 0, 'features.8.bias': 0, 'features.8.weight': 0, 'features.7.bias': 0, 'features.7.weight': 0, 'features.4.bias': 0, 'features.4.weight': 0, 'features.3.bias': 0, 'features.3.weight': 0, 'features.1.bias': 0, 'features.1.weight': 0, 'features.0.bias': 0, 'features.0.weight': 0}
2025-05-23 11:48:00,112 [allreducer.py:696] INFO offsets: 
2025-05-23 11:48:00,112 [allreducer.py:343] INFO dynamic densities = [0.01]
2025-05-23 11:48:00,137 [allreducer.py:655] INFO spar_groups: [{'features.0.weight': ((0, 1728), (0, 1728)), 'features.0.bias': ((0, 64), (1728, 1792)), 'features.1.weight': ((0, 64), (1792, 1856)), 'features.1.bias': ((0, 64), (1856, 1920)), 'features.3.weight': ((0, 36864), (1920, 38784)), 'features.3.bias': ((0, 64), (38784, 38848)), 'features.4.weight': ((0, 64), (38848, 38912)), 'features.4.bias': ((0, 64), (38912, 38976)), 'features.7.weight': ((0, 73728), (38976, 112704)), 'features.7.bias': ((0, 128), (112704, 112832)), 'features.8.weight': ((0, 128), (112832, 112960)), 'features.8.bias': ((0, 128), (112960, 113088)), 'features.10.weight': ((0, 147456), (113088, 260544)), 'features.10.bias': ((0, 128), (260544, 260672)), 'features.11.weight': ((0, 128), (260672, 260800)), 'features.11.bias': ((0, 128), (260800, 260928)), 'features.14.weight': ((0, 294912), (260928, 555840)), 'features.14.bias': ((0, 256), (555840, 556096)), 'features.15.weight': ((0, 256), (556096, 556352)), 'features.15.bias': ((0, 256), (556352, 556608)), 'features.17.weight': ((0, 589824), (556608, 1146432)), 'features.17.bias': ((0, 256), (1146432, 1146688)), 'features.18.weight': ((0, 256), (1146688, 1146944)), 'features.18.bias': ((0, 256), (1146944, 1147200)), 'features.20.weight': ((0, 589824), (1147200, 1737024)), 'features.20.bias': ((0, 256), (1737024, 1737280)), 'features.21.weight': ((0, 256), (1737280, 1737536)), 'features.21.bias': ((0, 256), (1737536, 1737792)), 'features.24.weight': ((0, 716919), (1737792, 2454711))}, {'features.24.weight': ((716919, 1179648), (0, 462729)), 'features.24.bias': ((0, 512), (462729, 463241)), 'features.25.weight': ((0, 512), (463241, 463753)), 'features.25.bias': ((0, 512), (463753, 464265)), 'features.27.weight': ((0, 1990446), (464265, 2454711))}, {'features.27.weight': ((1990446, 2359296), (0, 368850)), 'features.27.bias': ((0, 512), (368850, 369362)), 'features.28.weight': ((0, 512), (369362, 369874)), 'features.28.bias': ((0, 512), (369874, 370386)), 'features.30.weight': ((0, 2084325), (370386, 2454711))}, {'features.30.weight': ((2084325, 2359296), (0, 274971)), 'features.30.bias': ((0, 512), (274971, 275483)), 'features.31.weight': ((0, 512), (275483, 275995)), 'features.31.bias': ((0, 512), (275995, 276507)), 'features.34.weight': ((0, 2178204), (276507, 2454711))}, {'features.34.weight': ((2178204, 2359296), (0, 181092)), 'features.34.bias': ((0, 512), (181092, 181604)), 'features.35.weight': ((0, 512), (181604, 182116)), 'features.35.bias': ((0, 512), (182116, 182628)), 'features.37.weight': ((0, 2272083), (182628, 2454711))}, {'features.37.weight': ((2272083, 2359296), (0, 87213)), 'features.37.bias': ((0, 512), (87213, 87725)), 'features.38.weight': ((0, 512), (87725, 88237)), 'features.38.bias': ((0, 512), (88237, 88749)), 'features.40.weight': ((0, 2359296), (88749, 2448045)), 'features.40.bias': ((0, 512), (2448045, 2448557)), 'features.41.weight': ((0, 512), (2448557, 2449069)), 'features.41.bias': ((0, 512), (2449069, 2449581)), 'fc.weight': ((0, 5120), (2449581, 2454701)), 'fc.bias': ((0, 10), (2454701, 2454711))}]
2025-05-23 11:48:00,138 [allreducer.py:656] INFO spar_key_groupidx_maps: {'features.0.weight': [0], 'features.0.bias': [0], 'features.1.weight': [0], 'features.1.bias': [0], 'features.3.weight': [0], 'features.3.bias': [0], 'features.4.weight': [0], 'features.4.bias': [0], 'features.7.weight': [0], 'features.7.bias': [0], 'features.8.weight': [0], 'features.8.bias': [0], 'features.10.weight': [0], 'features.10.bias': [0], 'features.11.weight': [0], 'features.11.bias': [0], 'features.14.weight': [0], 'features.14.bias': [0], 'features.15.weight': [0], 'features.15.bias': [0], 'features.17.weight': [0], 'features.17.bias': [0], 'features.18.weight': [0], 'features.18.bias': [0], 'features.20.weight': [0], 'features.20.bias': [0], 'features.21.weight': [0], 'features.21.bias': [0], 'features.24.weight': [0, 1], 'features.24.bias': [1], 'features.25.weight': [1], 'features.25.bias': [1], 'features.27.weight': [1, 2], 'features.27.bias': [2], 'features.28.weight': [2], 'features.28.bias': [2], 'features.30.weight': [2, 3], 'features.30.bias': [3], 'features.31.weight': [3], 'features.31.bias': [3], 'features.34.weight': [3, 4], 'features.34.bias': [4], 'features.35.weight': [4], 'features.35.bias': [4], 'features.37.weight': [4, 5], 'features.37.bias': [5], 'features.38.weight': [5], 'features.38.bias': [5], 'features.40.weight': [5], 'features.40.bias': [5], 'features.41.weight': [5], 'features.41.bias': [5], 'fc.weight': [5], 'fc.bias': [5]}
2025-05-23 11:48:00,159 [allreducer.py:972] INFO Allreducer thread started ...
2025-05-23 11:48:00,159 [main_trainer.py:119] INFO Start training ....
2025-05-23 11:48:09,438 [main_trainer.py:147] INFO Time per iteration including communication: 0.441806. computation: 0.247908. Speed: 72.429949 images/s, current density: 0.010000
2025-05-23 11:48:14,723 [main_trainer.py:147] INFO Time per iteration including communication: 0.355143. computation: 0.183872. Speed: 90.104545 images/s, current density: 0.010000
2025-05-23 11:48:17,008 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-23 11:48:17,008 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000142,0.048383,0.127935,0.001278,0.000000,0.000000
2025-05-23 11:52:34,515 [main_trainer.py:279] INFO Configurations: Namespace(batch_size=32, nsteps_update=1, nworkers=6, nwpernode=1, compression=True, compressor='spardl', sigma_scale=2.5, density=0.01, dataset='cifar10', dnn='vgg16', data_dir='./vgg_data', lr=0.1, max_epochs=121, pretrain=None)
2025-05-23 11:52:34,516 [main_trainer.py:281] INFO Interpreter: 3.9.16 (main, Mar  1 2023, 18:22:10) 
[GCC 11.2.0]
2025-05-23 11:52:41,743 [dl_trainer.py:280] INFO target_sparsities: [1.0]
2025-05-23 11:52:41,743 [dl_trainer.py:290] INFO num_batches_per_epoch: 260
2025-05-23 11:52:41,744 [main_trainer.py:81] INFO Broadcast parameters....
2025-05-23 11:52:42,193 [main_trainer.py:96] INFO Broadcast parameters finished....
2025-05-23 11:52:42,198 [allreducer.py:281] INFO density: 0.010000
2025-05-23 11:52:42,199 [allreducer.py:282] INFO threshold scale: 1.092000
2025-05-23 11:52:42,199 [allreducer.py:663] INFO groups: [['fc.bias', 'fc.weight', 'features.41.bias', 'features.41.weight', 'features.40.bias', 'features.40.weight', 'features.38.bias', 'features.38.weight', 'features.37.bias', 'features.37.weight', 'features.35.bias', 'features.35.weight', 'features.34.bias', 'features.34.weight', 'features.31.bias', 'features.31.weight', 'features.30.bias', 'features.30.weight', 'features.28.bias', 'features.28.weight', 'features.27.bias', 'features.27.weight', 'features.25.bias', 'features.25.weight', 'features.24.bias', 'features.24.weight', 'features.21.bias', 'features.21.weight', 'features.20.bias', 'features.20.weight', 'features.18.bias', 'features.18.weight', 'features.17.bias', 'features.17.weight', 'features.15.bias', 'features.15.weight', 'features.14.bias', 'features.14.weight', 'features.11.bias', 'features.11.weight', 'features.10.bias', 'features.10.weight', 'features.8.bias', 'features.8.weight', 'features.7.bias', 'features.7.weight', 'features.4.bias', 'features.4.weight', 'features.3.bias', 'features.3.weight', 'features.1.bias', 'features.1.weight', 'features.0.bias', 'features.0.weight']]
2025-05-23 11:52:42,199 [allreducer.py:664] INFO key_groupidx_maps: {'fc.bias': 0, 'fc.weight': 0, 'features.41.bias': 0, 'features.41.weight': 0, 'features.40.bias': 0, 'features.40.weight': 0, 'features.38.bias': 0, 'features.38.weight': 0, 'features.37.bias': 0, 'features.37.weight': 0, 'features.35.bias': 0, 'features.35.weight': 0, 'features.34.bias': 0, 'features.34.weight': 0, 'features.31.bias': 0, 'features.31.weight': 0, 'features.30.bias': 0, 'features.30.weight': 0, 'features.28.bias': 0, 'features.28.weight': 0, 'features.27.bias': 0, 'features.27.weight': 0, 'features.25.bias': 0, 'features.25.weight': 0, 'features.24.bias': 0, 'features.24.weight': 0, 'features.21.bias': 0, 'features.21.weight': 0, 'features.20.bias': 0, 'features.20.weight': 0, 'features.18.bias': 0, 'features.18.weight': 0, 'features.17.bias': 0, 'features.17.weight': 0, 'features.15.bias': 0, 'features.15.weight': 0, 'features.14.bias': 0, 'features.14.weight': 0, 'features.11.bias': 0, 'features.11.weight': 0, 'features.10.bias': 0, 'features.10.weight': 0, 'features.8.bias': 0, 'features.8.weight': 0, 'features.7.bias': 0, 'features.7.weight': 0, 'features.4.bias': 0, 'features.4.weight': 0, 'features.3.bias': 0, 'features.3.weight': 0, 'features.1.bias': 0, 'features.1.weight': 0, 'features.0.bias': 0, 'features.0.weight': 0}
2025-05-23 11:52:42,199 [allreducer.py:696] INFO offsets: 
2025-05-23 11:52:42,200 [allreducer.py:343] INFO dynamic densities = [0.01]
2025-05-23 11:52:42,202 [allreducer.py:655] INFO spar_groups: [{'features.0.weight': ((0, 1728), (0, 1728)), 'features.0.bias': ((0, 64), (1728, 1792)), 'features.1.weight': ((0, 64), (1792, 1856)), 'features.1.bias': ((0, 64), (1856, 1920)), 'features.3.weight': ((0, 36864), (1920, 38784)), 'features.3.bias': ((0, 64), (38784, 38848)), 'features.4.weight': ((0, 64), (38848, 38912)), 'features.4.bias': ((0, 64), (38912, 38976)), 'features.7.weight': ((0, 73728), (38976, 112704)), 'features.7.bias': ((0, 128), (112704, 112832)), 'features.8.weight': ((0, 128), (112832, 112960)), 'features.8.bias': ((0, 128), (112960, 113088)), 'features.10.weight': ((0, 147456), (113088, 260544)), 'features.10.bias': ((0, 128), (260544, 260672)), 'features.11.weight': ((0, 128), (260672, 260800)), 'features.11.bias': ((0, 128), (260800, 260928)), 'features.14.weight': ((0, 294912), (260928, 555840)), 'features.14.bias': ((0, 256), (555840, 556096)), 'features.15.weight': ((0, 256), (556096, 556352)), 'features.15.bias': ((0, 256), (556352, 556608)), 'features.17.weight': ((0, 589824), (556608, 1146432)), 'features.17.bias': ((0, 256), (1146432, 1146688)), 'features.18.weight': ((0, 256), (1146688, 1146944)), 'features.18.bias': ((0, 256), (1146944, 1147200)), 'features.20.weight': ((0, 589824), (1147200, 1737024)), 'features.20.bias': ((0, 256), (1737024, 1737280)), 'features.21.weight': ((0, 256), (1737280, 1737536)), 'features.21.bias': ((0, 256), (1737536, 1737792)), 'features.24.weight': ((0, 716919), (1737792, 2454711))}, {'features.24.weight': ((716919, 1179648), (0, 462729)), 'features.24.bias': ((0, 512), (462729, 463241)), 'features.25.weight': ((0, 512), (463241, 463753)), 'features.25.bias': ((0, 512), (463753, 464265)), 'features.27.weight': ((0, 1990446), (464265, 2454711))}, {'features.27.weight': ((1990446, 2359296), (0, 368850)), 'features.27.bias': ((0, 512), (368850, 369362)), 'features.28.weight': ((0, 512), (369362, 369874)), 'features.28.bias': ((0, 512), (369874, 370386)), 'features.30.weight': ((0, 2084325), (370386, 2454711))}, {'features.30.weight': ((2084325, 2359296), (0, 274971)), 'features.30.bias': ((0, 512), (274971, 275483)), 'features.31.weight': ((0, 512), (275483, 275995)), 'features.31.bias': ((0, 512), (275995, 276507)), 'features.34.weight': ((0, 2178204), (276507, 2454711))}, {'features.34.weight': ((2178204, 2359296), (0, 181092)), 'features.34.bias': ((0, 512), (181092, 181604)), 'features.35.weight': ((0, 512), (181604, 182116)), 'features.35.bias': ((0, 512), (182116, 182628)), 'features.37.weight': ((0, 2272083), (182628, 2454711))}, {'features.37.weight': ((2272083, 2359296), (0, 87213)), 'features.37.bias': ((0, 512), (87213, 87725)), 'features.38.weight': ((0, 512), (87725, 88237)), 'features.38.bias': ((0, 512), (88237, 88749)), 'features.40.weight': ((0, 2359296), (88749, 2448045)), 'features.40.bias': ((0, 512), (2448045, 2448557)), 'features.41.weight': ((0, 512), (2448557, 2449069)), 'features.41.bias': ((0, 512), (2449069, 2449581)), 'fc.weight': ((0, 5120), (2449581, 2454701)), 'fc.bias': ((0, 10), (2454701, 2454711))}]
2025-05-23 11:52:42,202 [allreducer.py:656] INFO spar_key_groupidx_maps: {'features.0.weight': [0], 'features.0.bias': [0], 'features.1.weight': [0], 'features.1.bias': [0], 'features.3.weight': [0], 'features.3.bias': [0], 'features.4.weight': [0], 'features.4.bias': [0], 'features.7.weight': [0], 'features.7.bias': [0], 'features.8.weight': [0], 'features.8.bias': [0], 'features.10.weight': [0], 'features.10.bias': [0], 'features.11.weight': [0], 'features.11.bias': [0], 'features.14.weight': [0], 'features.14.bias': [0], 'features.15.weight': [0], 'features.15.bias': [0], 'features.17.weight': [0], 'features.17.bias': [0], 'features.18.weight': [0], 'features.18.bias': [0], 'features.20.weight': [0], 'features.20.bias': [0], 'features.21.weight': [0], 'features.21.bias': [0], 'features.24.weight': [0, 1], 'features.24.bias': [1], 'features.25.weight': [1], 'features.25.bias': [1], 'features.27.weight': [1, 2], 'features.27.bias': [2], 'features.28.weight': [2], 'features.28.bias': [2], 'features.30.weight': [2, 3], 'features.30.bias': [3], 'features.31.weight': [3], 'features.31.bias': [3], 'features.34.weight': [3, 4], 'features.34.bias': [4], 'features.35.weight': [4], 'features.35.bias': [4], 'features.37.weight': [4, 5], 'features.37.bias': [5], 'features.38.weight': [5], 'features.38.bias': [5], 'features.40.weight': [5], 'features.40.bias': [5], 'features.41.weight': [5], 'features.41.bias': [5], 'fc.weight': [5], 'fc.bias': [5]}
2025-05-23 11:52:42,212 [allreducer.py:972] INFO Allreducer thread started ...
2025-05-23 11:52:42,212 [main_trainer.py:119] INFO Start training ....
2025-05-23 11:52:54,636 [main_trainer.py:147] INFO Time per iteration including communication: 0.591537. computation: 0.421756. Speed: 54.096321 images/s, current density: 0.010000
2025-05-28 08:53:20,837 [main_trainer.py:279] INFO Configurations: Namespace(batch_size=32, nsteps_update=1, nworkers=6, nwpernode=1, compression=True, compressor='spardl', sigma_scale=2.5, density=0.01, dataset='cifar10', dnn='vgg16', data_dir='./vgg_data', lr=0.1, max_epochs=121, pretrain=None)
2025-05-28 08:53:20,838 [main_trainer.py:281] INFO Interpreter: 3.9.16 (main, Mar  1 2023, 18:22:10) 
[GCC 11.2.0]
2025-05-28 08:53:25,117 [dl_trainer.py:280] INFO target_sparsities: [1.0]
2025-05-28 08:53:25,118 [dl_trainer.py:290] INFO num_batches_per_epoch: 260
2025-05-28 08:53:25,118 [main_trainer.py:81] INFO Broadcast parameters....
2025-05-28 08:53:25,504 [main_trainer.py:96] INFO Broadcast parameters finished....
2025-05-28 08:53:25,509 [allreducer.py:281] INFO density: 0.010000
2025-05-28 08:53:25,509 [allreducer.py:282] INFO threshold scale: 1.092000
2025-05-28 08:53:25,510 [allreducer.py:663] INFO groups: [['fc.bias', 'fc.weight', 'features.41.bias', 'features.41.weight', 'features.40.bias', 'features.40.weight', 'features.38.bias', 'features.38.weight', 'features.37.bias', 'features.37.weight', 'features.35.bias', 'features.35.weight', 'features.34.bias', 'features.34.weight', 'features.31.bias', 'features.31.weight', 'features.30.bias', 'features.30.weight', 'features.28.bias', 'features.28.weight', 'features.27.bias', 'features.27.weight', 'features.25.bias', 'features.25.weight', 'features.24.bias', 'features.24.weight', 'features.21.bias', 'features.21.weight', 'features.20.bias', 'features.20.weight', 'features.18.bias', 'features.18.weight', 'features.17.bias', 'features.17.weight', 'features.15.bias', 'features.15.weight', 'features.14.bias', 'features.14.weight', 'features.11.bias', 'features.11.weight', 'features.10.bias', 'features.10.weight', 'features.8.bias', 'features.8.weight', 'features.7.bias', 'features.7.weight', 'features.4.bias', 'features.4.weight', 'features.3.bias', 'features.3.weight', 'features.1.bias', 'features.1.weight', 'features.0.bias', 'features.0.weight']]
2025-05-28 08:53:25,510 [allreducer.py:664] INFO key_groupidx_maps: {'fc.bias': 0, 'fc.weight': 0, 'features.41.bias': 0, 'features.41.weight': 0, 'features.40.bias': 0, 'features.40.weight': 0, 'features.38.bias': 0, 'features.38.weight': 0, 'features.37.bias': 0, 'features.37.weight': 0, 'features.35.bias': 0, 'features.35.weight': 0, 'features.34.bias': 0, 'features.34.weight': 0, 'features.31.bias': 0, 'features.31.weight': 0, 'features.30.bias': 0, 'features.30.weight': 0, 'features.28.bias': 0, 'features.28.weight': 0, 'features.27.bias': 0, 'features.27.weight': 0, 'features.25.bias': 0, 'features.25.weight': 0, 'features.24.bias': 0, 'features.24.weight': 0, 'features.21.bias': 0, 'features.21.weight': 0, 'features.20.bias': 0, 'features.20.weight': 0, 'features.18.bias': 0, 'features.18.weight': 0, 'features.17.bias': 0, 'features.17.weight': 0, 'features.15.bias': 0, 'features.15.weight': 0, 'features.14.bias': 0, 'features.14.weight': 0, 'features.11.bias': 0, 'features.11.weight': 0, 'features.10.bias': 0, 'features.10.weight': 0, 'features.8.bias': 0, 'features.8.weight': 0, 'features.7.bias': 0, 'features.7.weight': 0, 'features.4.bias': 0, 'features.4.weight': 0, 'features.3.bias': 0, 'features.3.weight': 0, 'features.1.bias': 0, 'features.1.weight': 0, 'features.0.bias': 0, 'features.0.weight': 0}
2025-05-28 08:53:25,510 [allreducer.py:696] INFO offsets: 
2025-05-28 08:53:25,510 [allreducer.py:343] INFO dynamic densities = [0.01]
2025-05-28 08:53:25,513 [allreducer.py:655] INFO spar_groups: [{'features.0.weight': ((0, 1728), (0, 1728)), 'features.0.bias': ((0, 64), (1728, 1792)), 'features.1.weight': ((0, 64), (1792, 1856)), 'features.1.bias': ((0, 64), (1856, 1920)), 'features.3.weight': ((0, 36864), (1920, 38784)), 'features.3.bias': ((0, 64), (38784, 38848)), 'features.4.weight': ((0, 64), (38848, 38912)), 'features.4.bias': ((0, 64), (38912, 38976)), 'features.7.weight': ((0, 73728), (38976, 112704)), 'features.7.bias': ((0, 128), (112704, 112832)), 'features.8.weight': ((0, 128), (112832, 112960)), 'features.8.bias': ((0, 128), (112960, 113088)), 'features.10.weight': ((0, 147456), (113088, 260544)), 'features.10.bias': ((0, 128), (260544, 260672)), 'features.11.weight': ((0, 128), (260672, 260800)), 'features.11.bias': ((0, 128), (260800, 260928)), 'features.14.weight': ((0, 294912), (260928, 555840)), 'features.14.bias': ((0, 256), (555840, 556096)), 'features.15.weight': ((0, 256), (556096, 556352)), 'features.15.bias': ((0, 256), (556352, 556608)), 'features.17.weight': ((0, 589824), (556608, 1146432)), 'features.17.bias': ((0, 256), (1146432, 1146688)), 'features.18.weight': ((0, 256), (1146688, 1146944)), 'features.18.bias': ((0, 256), (1146944, 1147200)), 'features.20.weight': ((0, 589824), (1147200, 1737024)), 'features.20.bias': ((0, 256), (1737024, 1737280)), 'features.21.weight': ((0, 256), (1737280, 1737536)), 'features.21.bias': ((0, 256), (1737536, 1737792)), 'features.24.weight': ((0, 716919), (1737792, 2454711))}, {'features.24.weight': ((716919, 1179648), (0, 462729)), 'features.24.bias': ((0, 512), (462729, 463241)), 'features.25.weight': ((0, 512), (463241, 463753)), 'features.25.bias': ((0, 512), (463753, 464265)), 'features.27.weight': ((0, 1990446), (464265, 2454711))}, {'features.27.weight': ((1990446, 2359296), (0, 368850)), 'features.27.bias': ((0, 512), (368850, 369362)), 'features.28.weight': ((0, 512), (369362, 369874)), 'features.28.bias': ((0, 512), (369874, 370386)), 'features.30.weight': ((0, 2084325), (370386, 2454711))}, {'features.30.weight': ((2084325, 2359296), (0, 274971)), 'features.30.bias': ((0, 512), (274971, 275483)), 'features.31.weight': ((0, 512), (275483, 275995)), 'features.31.bias': ((0, 512), (275995, 276507)), 'features.34.weight': ((0, 2178204), (276507, 2454711))}, {'features.34.weight': ((2178204, 2359296), (0, 181092)), 'features.34.bias': ((0, 512), (181092, 181604)), 'features.35.weight': ((0, 512), (181604, 182116)), 'features.35.bias': ((0, 512), (182116, 182628)), 'features.37.weight': ((0, 2272083), (182628, 2454711))}, {'features.37.weight': ((2272083, 2359296), (0, 87213)), 'features.37.bias': ((0, 512), (87213, 87725)), 'features.38.weight': ((0, 512), (87725, 88237)), 'features.38.bias': ((0, 512), (88237, 88749)), 'features.40.weight': ((0, 2359296), (88749, 2448045)), 'features.40.bias': ((0, 512), (2448045, 2448557)), 'features.41.weight': ((0, 512), (2448557, 2449069)), 'features.41.bias': ((0, 512), (2449069, 2449581)), 'fc.weight': ((0, 5120), (2449581, 2454701)), 'fc.bias': ((0, 10), (2454701, 2454711))}]
2025-05-28 08:53:25,513 [allreducer.py:656] INFO spar_key_groupidx_maps: {'features.0.weight': [0], 'features.0.bias': [0], 'features.1.weight': [0], 'features.1.bias': [0], 'features.3.weight': [0], 'features.3.bias': [0], 'features.4.weight': [0], 'features.4.bias': [0], 'features.7.weight': [0], 'features.7.bias': [0], 'features.8.weight': [0], 'features.8.bias': [0], 'features.10.weight': [0], 'features.10.bias': [0], 'features.11.weight': [0], 'features.11.bias': [0], 'features.14.weight': [0], 'features.14.bias': [0], 'features.15.weight': [0], 'features.15.bias': [0], 'features.17.weight': [0], 'features.17.bias': [0], 'features.18.weight': [0], 'features.18.bias': [0], 'features.20.weight': [0], 'features.20.bias': [0], 'features.21.weight': [0], 'features.21.bias': [0], 'features.24.weight': [0, 1], 'features.24.bias': [1], 'features.25.weight': [1], 'features.25.bias': [1], 'features.27.weight': [1, 2], 'features.27.bias': [2], 'features.28.weight': [2], 'features.28.bias': [2], 'features.30.weight': [2, 3], 'features.30.bias': [3], 'features.31.weight': [3], 'features.31.bias': [3], 'features.34.weight': [3, 4], 'features.34.bias': [4], 'features.35.weight': [4], 'features.35.bias': [4], 'features.37.weight': [4, 5], 'features.37.bias': [5], 'features.38.weight': [5], 'features.38.bias': [5], 'features.40.weight': [5], 'features.40.bias': [5], 'features.41.weight': [5], 'features.41.bias': [5], 'fc.weight': [5], 'fc.bias': [5]}
2025-05-28 08:53:25,522 [allreducer.py:972] INFO Allreducer thread started ...
2025-05-28 08:53:25,522 [main_trainer.py:119] INFO Start training ....
2025-05-28 08:53:31,704 [main_trainer.py:147] INFO Time per iteration including communication: 0.291804. computation: 0.211723. Speed: 109.662622 images/s, current density: 0.010000
2025-05-28 08:53:35,287 [main_trainer.py:147] INFO Time per iteration including communication: 0.236814. computation: 0.158144. Speed: 135.127426 images/s, current density: 0.010000
2025-05-28 08:53:36,916 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:53:36,916 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000083,0.017078,0.041940,0.001313,0.000000,0.000000
2025-05-28 08:53:38,929 [main_trainer.py:147] INFO Time per iteration including communication: 0.218849. computation: 0.140481. Speed: 146.219731 images/s, current density: 0.010000
2025-05-28 08:53:42,570 [main_trainer.py:147] INFO Time per iteration including communication: 0.209744. computation: 0.131440. Speed: 152.566853 images/s, current density: 0.010000
2025-05-28 08:53:46,018 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:53:46,019 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000084,0.017070,0.040739,0.001079,0.000000,0.000000
2025-05-28 08:53:46,209 [main_trainer.py:147] INFO Time per iteration including communication: 0.204226. computation: 0.126121. Speed: 156.688806 images/s, current density: 0.010000
2025-05-28 08:53:49,852 [main_trainer.py:147] INFO Time per iteration including communication: 0.200563. computation: 0.122504. Speed: 159.550489 images/s, current density: 0.010000
2025-05-28 08:53:53,534 [main_trainer.py:147] INFO Time per iteration including communication: 0.197844. computation: 0.119827. Speed: 161.743269 images/s, current density: 0.010000
2025-05-28 08:53:55,107 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:53:55,107 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.016944,0.040434,0.001096,0.000000,0.000000
2025-05-28 08:53:57,107 [main_trainer.py:147] INFO Time per iteration including communication: 0.195454. computation: 0.117617. Speed: 163.721080 images/s, current density: 0.010000
2025-05-28 08:54:00,737 [main_trainer.py:147] INFO Time per iteration including communication: 0.193909. computation: 0.116126. Speed: 165.026234 images/s, current density: 0.010000
2025-05-28 08:54:04,176 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:54:04,177 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.017589,0.040830,0.001089,0.000000,0.000000
2025-05-28 08:54:04,360 [main_trainer.py:147] INFO Time per iteration including communication: 0.192633. computation: 0.114924. Speed: 166.119159 images/s, current density: 0.010000
2025-05-28 08:54:07,977 [main_trainer.py:147] INFO Time per iteration including communication: 0.191561. computation: 0.113894. Speed: 167.048741 images/s, current density: 0.010000
2025-05-28 08:54:11,610 [main_trainer.py:147] INFO Time per iteration including communication: 0.190729. computation: 0.113083. Speed: 167.777164 images/s, current density: 0.010000
2025-05-28 08:54:13,236 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:54:13,237 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000083,0.017246,0.041031,0.001062,0.000000,0.000000
2025-05-28 08:54:15,007 [dl_trainer.py:876] INFO [  0][  260/  260][rank:0] loss: 2.015, average forward and backward time: 0.136047, iotime: 0.022024 
2025-05-28 08:54:15,108 [dl_trainer.py:882] INFO GPU memory usage memory_allocated: 511 MBytes, max_memory_allocated: 665 MBytes, memory_cached: 696 MBytes, max_memory_cached: 696 MBytes, CPU memory usage: 3073 MBytes
2025-05-28 08:54:15,157 [main_trainer.py:153] INFO Time per epoch including communication: 49.634663, 10.646899
2025-05-28 08:54:15,159 [dl_trainer.py:740] INFO train iter: 260, num_batches_per_epoch: 260
2025-05-28 08:54:15,160 [dl_trainer.py:743] INFO Epoch 0, avg train acc: 17.920673, lr: 0.025000, avg loss: 2.390497
2025-05-28 08:54:15,191 [dl_trainer.py:749] WARNING NaN detected! sparsities:  []
2025-05-28 08:54:15,192 [dl_trainer.py:751] INFO Average Sparsity: nan, compression ratio: nan, communication size: nan
2025-05-28 08:54:18,096 [dl_trainer.py:975] INFO Epoch 1, lr: 0.025000, val loss: 1.948381, val acc: 0.258800
2025-05-28 08:54:21,818 [main_trainer.py:147] INFO Time per iteration including communication: 0.199898. computation: 0.111364. Speed: 160.081446 images/s, current density: 0.010000
2025-05-28 08:54:25,238 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:54:25,238 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016555,0.041225,0.001061,0.000000,0.000000
2025-05-28 08:54:25,427 [main_trainer.py:147] INFO Time per iteration including communication: 0.198603. computation: 0.110716. Speed: 161.125744 images/s, current density: 0.010000
2025-05-28 08:54:29,057 [main_trainer.py:147] INFO Time per iteration including communication: 0.197534. computation: 0.110299. Speed: 161.997382 images/s, current density: 0.010000
2025-05-28 08:54:32,697 [main_trainer.py:147] INFO Time per iteration including communication: 0.196617. computation: 0.109941. Speed: 162.752758 images/s, current density: 0.010000
2025-05-28 08:54:34,325 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:54:34,326 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.017491,0.041155,0.001052,0.000000,0.000000
2025-05-28 08:54:36,329 [main_trainer.py:147] INFO Time per iteration including communication: 0.195779. computation: 0.109564. Speed: 163.449241 images/s, current density: 0.010000
2025-05-28 08:54:39,960 [main_trainer.py:147] INFO Time per iteration including communication: 0.195032. computation: 0.109294. Speed: 164.075784 images/s, current density: 0.010000
2025-05-28 08:54:43,398 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:54:43,399 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.017198,0.041922,0.001054,0.000000,0.000000
2025-05-28 08:54:43,592 [main_trainer.py:147] INFO Time per iteration including communication: 0.194356. computation: 0.109006. Speed: 164.646081 images/s, current density: 0.010000
2025-05-28 08:54:47,224 [main_trainer.py:147] INFO Time per iteration including communication: 0.193749. computation: 0.108793. Speed: 165.162272 images/s, current density: 0.010000
2025-05-28 08:54:50,842 [main_trainer.py:147] INFO Time per iteration including communication: 0.193164. computation: 0.108569. Speed: 165.662062 images/s, current density: 0.010000
2025-05-28 08:54:52,458 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:54:52,458 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000083,0.017289,0.041039,0.001098,0.000000,0.000000
2025-05-28 08:54:54,469 [main_trainer.py:147] INFO Time per iteration including communication: 0.192647. computation: 0.108369. Speed: 166.106834 images/s, current density: 0.010000
2025-05-28 08:54:58,104 [main_trainer.py:147] INFO Time per iteration including communication: 0.192191. computation: 0.108201. Speed: 166.501284 images/s, current density: 0.010000
2025-05-28 08:55:01,534 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:55:01,534 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.017171,0.041255,0.001083,0.000000,0.000000
2025-05-28 08:55:01,724 [main_trainer.py:147] INFO Time per iteration including communication: 0.191741. computation: 0.108026. Speed: 166.891727 images/s, current density: 0.010000
2025-05-28 08:55:05,114 [dl_trainer.py:876] INFO [  1][  520/  260][rank:0] loss: 1.299, average forward and backward time: 0.138054, iotime: 0.021796 
2025-05-28 08:55:05,119 [dl_trainer.py:882] INFO GPU memory usage memory_allocated: 511 MBytes, max_memory_allocated: 744 MBytes, memory_cached: 782 MBytes, max_memory_cached: 782 MBytes, CPU memory usage: 3075 MBytes
2025-05-28 08:55:05,171 [main_trainer.py:153] INFO Time per epoch including communication: 47.074350, 21.390601
2025-05-28 08:55:05,172 [dl_trainer.py:740] INFO train iter: 520, num_batches_per_epoch: 260
2025-05-28 08:55:05,173 [dl_trainer.py:743] INFO Epoch 1, avg train acc: 31.911058, lr: 0.033333, avg loss: 1.804768
2025-05-28 08:55:05,173 [dl_trainer.py:749] WARNING NaN detected! sparsities:  []
2025-05-28 08:55:05,173 [dl_trainer.py:751] INFO Average Sparsity: nan, compression ratio: nan, communication size: nan
2025-05-28 08:55:08,123 [dl_trainer.py:975] INFO Epoch 2, lr: 0.033333, val loss: 1.679334, val acc: 0.368600
2025-05-28 08:55:11,840 [main_trainer.py:147] INFO Time per iteration including communication: 0.196259. computation: 0.107600. Speed: 163.050109 images/s, current density: 0.010000
2025-05-28 08:55:13,471 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:55:13,471 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000085,0.017205,0.040914,0.001078,0.000000,0.000000
2025-05-28 08:55:15,467 [main_trainer.py:147] INFO Time per iteration including communication: 0.195725. computation: 0.107459. Speed: 163.494493 images/s, current density: 0.010000
2025-05-28 08:55:19,094 [main_trainer.py:147] INFO Time per iteration including communication: 0.195226. computation: 0.107332. Speed: 163.912441 images/s, current density: 0.010000
2025-05-28 08:55:22,528 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:55:22,529 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.017046,0.041570,0.001104,0.000000,0.000000
2025-05-28 08:55:22,720 [main_trainer.py:147] INFO Time per iteration including communication: 0.194760. computation: 0.107240. Speed: 164.304449 images/s, current density: 0.010000
2025-05-28 08:55:26,360 [main_trainer.py:147] INFO Time per iteration including communication: 0.194348. computation: 0.107166. Speed: 164.652713 images/s, current density: 0.010000
2025-05-28 08:55:29,984 [main_trainer.py:147] INFO Time per iteration including communication: 0.193936. computation: 0.107066. Speed: 165.003244 images/s, current density: 0.010000
2025-05-28 08:55:31,608 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:55:31,609 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.017216,0.041123,0.001105,0.000000,0.000000
2025-05-28 08:55:33,617 [main_trainer.py:147] INFO Time per iteration including communication: 0.193563. computation: 0.106981. Speed: 165.320860 images/s, current density: 0.010000
2025-05-28 08:55:37,237 [main_trainer.py:147] INFO Time per iteration including communication: 0.193191. computation: 0.106893. Speed: 165.638840 images/s, current density: 0.010000
2025-05-28 08:55:40,672 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-05-28 08:55:40,673 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.017686,0.041030,0.001091,0.000000,0.000000
2025-05-28 08:55:40,865 [main_trainer.py:147] INFO Time per iteration including communication: 0.192851. computation: 0.106823. Speed: 165.930890 images/s, current density: 0.010000
2025-05-28 08:55:44,504 [main_trainer.py:147] INFO Time per iteration including communication: 0.192548. computation: 0.106743. Speed: 166.192293 images/s, current density: 0.010000
2025-05-28 08:55:48,128 [main_trainer.py:147] INFO Time per iteration including communication: 0.192240. computation: 0.106645. Speed: 166.458484 images/s, current density: 0.010000
2025-06-07 13:32:18,771 [main_trainer.py:279] INFO Configurations: Namespace(batch_size=32, nsteps_update=1, nworkers=6, nwpernode=1, compression=True, compressor='spardl', sigma_scale=2.5, density=0.01, dataset='cifar10', dnn='vgg16', data_dir='./vgg_data', lr=0.1, max_epochs=121, pretrain=None)
2025-06-07 13:32:18,771 [main_trainer.py:281] INFO Interpreter: 3.9.16 (main, Mar  1 2023, 18:22:10) 
[GCC 11.2.0]
2025-06-07 13:32:22,589 [dl_trainer.py:280] INFO target_sparsities: [1.0]
2025-06-07 13:32:22,590 [dl_trainer.py:290] INFO num_batches_per_epoch: 260
2025-06-07 13:32:22,598 [main_trainer.py:81] INFO Broadcast parameters....
2025-06-07 13:32:22,841 [main_trainer.py:96] INFO Broadcast parameters finished....
2025-06-07 13:32:22,846 [allreducer.py:281] INFO density: 0.010000
2025-06-07 13:32:22,846 [allreducer.py:282] INFO threshold scale: 1.092000
2025-06-07 13:32:22,846 [allreducer.py:663] INFO groups: [['fc.bias', 'fc.weight', 'features.41.bias', 'features.41.weight', 'features.40.bias', 'features.40.weight', 'features.38.bias', 'features.38.weight', 'features.37.bias', 'features.37.weight', 'features.35.bias', 'features.35.weight', 'features.34.bias', 'features.34.weight', 'features.31.bias', 'features.31.weight', 'features.30.bias', 'features.30.weight', 'features.28.bias', 'features.28.weight', 'features.27.bias', 'features.27.weight', 'features.25.bias', 'features.25.weight', 'features.24.bias', 'features.24.weight', 'features.21.bias', 'features.21.weight', 'features.20.bias', 'features.20.weight', 'features.18.bias', 'features.18.weight', 'features.17.bias', 'features.17.weight', 'features.15.bias', 'features.15.weight', 'features.14.bias', 'features.14.weight', 'features.11.bias', 'features.11.weight', 'features.10.bias', 'features.10.weight', 'features.8.bias', 'features.8.weight', 'features.7.bias', 'features.7.weight', 'features.4.bias', 'features.4.weight', 'features.3.bias', 'features.3.weight', 'features.1.bias', 'features.1.weight', 'features.0.bias', 'features.0.weight']]
2025-06-07 13:32:22,846 [allreducer.py:664] INFO key_groupidx_maps: {'fc.bias': 0, 'fc.weight': 0, 'features.41.bias': 0, 'features.41.weight': 0, 'features.40.bias': 0, 'features.40.weight': 0, 'features.38.bias': 0, 'features.38.weight': 0, 'features.37.bias': 0, 'features.37.weight': 0, 'features.35.bias': 0, 'features.35.weight': 0, 'features.34.bias': 0, 'features.34.weight': 0, 'features.31.bias': 0, 'features.31.weight': 0, 'features.30.bias': 0, 'features.30.weight': 0, 'features.28.bias': 0, 'features.28.weight': 0, 'features.27.bias': 0, 'features.27.weight': 0, 'features.25.bias': 0, 'features.25.weight': 0, 'features.24.bias': 0, 'features.24.weight': 0, 'features.21.bias': 0, 'features.21.weight': 0, 'features.20.bias': 0, 'features.20.weight': 0, 'features.18.bias': 0, 'features.18.weight': 0, 'features.17.bias': 0, 'features.17.weight': 0, 'features.15.bias': 0, 'features.15.weight': 0, 'features.14.bias': 0, 'features.14.weight': 0, 'features.11.bias': 0, 'features.11.weight': 0, 'features.10.bias': 0, 'features.10.weight': 0, 'features.8.bias': 0, 'features.8.weight': 0, 'features.7.bias': 0, 'features.7.weight': 0, 'features.4.bias': 0, 'features.4.weight': 0, 'features.3.bias': 0, 'features.3.weight': 0, 'features.1.bias': 0, 'features.1.weight': 0, 'features.0.bias': 0, 'features.0.weight': 0}
2025-06-07 13:32:22,847 [allreducer.py:696] INFO offsets: 
2025-06-07 13:32:22,848 [allreducer.py:343] INFO dynamic densities = [0.01]
2025-06-07 13:32:22,850 [allreducer.py:655] INFO spar_groups: [{'features.0.weight': ((0, 1728), (0, 1728)), 'features.0.bias': ((0, 64), (1728, 1792)), 'features.1.weight': ((0, 64), (1792, 1856)), 'features.1.bias': ((0, 64), (1856, 1920)), 'features.3.weight': ((0, 36864), (1920, 38784)), 'features.3.bias': ((0, 64), (38784, 38848)), 'features.4.weight': ((0, 64), (38848, 38912)), 'features.4.bias': ((0, 64), (38912, 38976)), 'features.7.weight': ((0, 73728), (38976, 112704)), 'features.7.bias': ((0, 128), (112704, 112832)), 'features.8.weight': ((0, 128), (112832, 112960)), 'features.8.bias': ((0, 128), (112960, 113088)), 'features.10.weight': ((0, 147456), (113088, 260544)), 'features.10.bias': ((0, 128), (260544, 260672)), 'features.11.weight': ((0, 128), (260672, 260800)), 'features.11.bias': ((0, 128), (260800, 260928)), 'features.14.weight': ((0, 294912), (260928, 555840)), 'features.14.bias': ((0, 256), (555840, 556096)), 'features.15.weight': ((0, 256), (556096, 556352)), 'features.15.bias': ((0, 256), (556352, 556608)), 'features.17.weight': ((0, 589824), (556608, 1146432)), 'features.17.bias': ((0, 256), (1146432, 1146688)), 'features.18.weight': ((0, 256), (1146688, 1146944)), 'features.18.bias': ((0, 256), (1146944, 1147200)), 'features.20.weight': ((0, 589824), (1147200, 1737024)), 'features.20.bias': ((0, 256), (1737024, 1737280)), 'features.21.weight': ((0, 256), (1737280, 1737536)), 'features.21.bias': ((0, 256), (1737536, 1737792)), 'features.24.weight': ((0, 716919), (1737792, 2454711))}, {'features.24.weight': ((716919, 1179648), (0, 462729)), 'features.24.bias': ((0, 512), (462729, 463241)), 'features.25.weight': ((0, 512), (463241, 463753)), 'features.25.bias': ((0, 512), (463753, 464265)), 'features.27.weight': ((0, 1990446), (464265, 2454711))}, {'features.27.weight': ((1990446, 2359296), (0, 368850)), 'features.27.bias': ((0, 512), (368850, 369362)), 'features.28.weight': ((0, 512), (369362, 369874)), 'features.28.bias': ((0, 512), (369874, 370386)), 'features.30.weight': ((0, 2084325), (370386, 2454711))}, {'features.30.weight': ((2084325, 2359296), (0, 274971)), 'features.30.bias': ((0, 512), (274971, 275483)), 'features.31.weight': ((0, 512), (275483, 275995)), 'features.31.bias': ((0, 512), (275995, 276507)), 'features.34.weight': ((0, 2178204), (276507, 2454711))}, {'features.34.weight': ((2178204, 2359296), (0, 181092)), 'features.34.bias': ((0, 512), (181092, 181604)), 'features.35.weight': ((0, 512), (181604, 182116)), 'features.35.bias': ((0, 512), (182116, 182628)), 'features.37.weight': ((0, 2272083), (182628, 2454711))}, {'features.37.weight': ((2272083, 2359296), (0, 87213)), 'features.37.bias': ((0, 512), (87213, 87725)), 'features.38.weight': ((0, 512), (87725, 88237)), 'features.38.bias': ((0, 512), (88237, 88749)), 'features.40.weight': ((0, 2359296), (88749, 2448045)), 'features.40.bias': ((0, 512), (2448045, 2448557)), 'features.41.weight': ((0, 512), (2448557, 2449069)), 'features.41.bias': ((0, 512), (2449069, 2449581)), 'fc.weight': ((0, 5120), (2449581, 2454701)), 'fc.bias': ((0, 10), (2454701, 2454711))}]
2025-06-07 13:32:22,850 [allreducer.py:656] INFO spar_key_groupidx_maps: {'features.0.weight': [0], 'features.0.bias': [0], 'features.1.weight': [0], 'features.1.bias': [0], 'features.3.weight': [0], 'features.3.bias': [0], 'features.4.weight': [0], 'features.4.bias': [0], 'features.7.weight': [0], 'features.7.bias': [0], 'features.8.weight': [0], 'features.8.bias': [0], 'features.10.weight': [0], 'features.10.bias': [0], 'features.11.weight': [0], 'features.11.bias': [0], 'features.14.weight': [0], 'features.14.bias': [0], 'features.15.weight': [0], 'features.15.bias': [0], 'features.17.weight': [0], 'features.17.bias': [0], 'features.18.weight': [0], 'features.18.bias': [0], 'features.20.weight': [0], 'features.20.bias': [0], 'features.21.weight': [0], 'features.21.bias': [0], 'features.24.weight': [0, 1], 'features.24.bias': [1], 'features.25.weight': [1], 'features.25.bias': [1], 'features.27.weight': [1, 2], 'features.27.bias': [2], 'features.28.weight': [2], 'features.28.bias': [2], 'features.30.weight': [2, 3], 'features.30.bias': [3], 'features.31.weight': [3], 'features.31.bias': [3], 'features.34.weight': [3, 4], 'features.34.bias': [4], 'features.35.weight': [4], 'features.35.bias': [4], 'features.37.weight': [4, 5], 'features.37.bias': [5], 'features.38.weight': [5], 'features.38.bias': [5], 'features.40.weight': [5], 'features.40.bias': [5], 'features.41.weight': [5], 'features.41.bias': [5], 'fc.weight': [5], 'fc.bias': [5]}
2025-06-07 13:32:22,857 [allreducer.py:972] INFO Allreducer thread started ...
2025-06-07 13:32:22,857 [main_trainer.py:119] INFO Start training ....
2025-06-07 13:32:28,828 [main_trainer.py:147] INFO Time per iteration including communication: 0.284259. computation: 0.204116. Speed: 112.573293 images/s, current density: 0.010000
2025-06-07 13:32:32,461 [main_trainer.py:147] INFO Time per iteration including communication: 0.234157. computation: 0.154983. Speed: 136.660175 images/s, current density: 0.010000
2025-06-07 13:32:34,086 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:32:34,087 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000088,0.016136,0.042544,0.001146,0.000000,0.000000
2025-06-07 13:32:36,100 [main_trainer.py:147] INFO Time per iteration including communication: 0.217000. computation: 0.138056. Speed: 147.465366 images/s, current density: 0.010000
2025-06-07 13:32:39,738 [main_trainer.py:147] INFO Time per iteration including communication: 0.208323. computation: 0.129689. Speed: 153.607522 images/s, current density: 0.010000
2025-06-07 13:32:43,188 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:32:43,188 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016487,0.041541,0.001012,0.000000,0.000000
2025-06-07 13:32:43,379 [main_trainer.py:147] INFO Time per iteration including communication: 0.203102. computation: 0.124716. Speed: 157.556034 images/s, current density: 0.010000
2025-06-07 13:32:47,018 [main_trainer.py:147] INFO Time per iteration including communication: 0.199591. computation: 0.121407. Speed: 160.327684 images/s, current density: 0.010000
2025-06-07 13:32:50,632 [main_trainer.py:147] INFO Time per iteration including communication: 0.196906. computation: 0.118821. Speed: 162.513856 images/s, current density: 0.010000
2025-06-07 13:32:52,256 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:32:52,256 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000084,0.016527,0.041953,0.001077,0.000000,0.000000
2025-06-07 13:32:54,264 [main_trainer.py:147] INFO Time per iteration including communication: 0.194998. computation: 0.117026. Speed: 164.103827 images/s, current density: 0.010000
2025-06-07 13:32:57,904 [main_trainer.py:147] INFO Time per iteration including communication: 0.193551. computation: 0.115673. Speed: 165.331055 images/s, current density: 0.010000
2025-06-07 13:33:01,340 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:33:01,340 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000087,0.016518,0.041596,0.001095,0.000000,0.000000
2025-06-07 13:33:01,531 [main_trainer.py:147] INFO Time per iteration including communication: 0.192337. computation: 0.114506. Speed: 166.374536 images/s, current density: 0.010000
2025-06-07 13:33:05,155 [main_trainer.py:147] INFO Time per iteration including communication: 0.191325. computation: 0.113507. Speed: 167.254537 images/s, current density: 0.010000
2025-06-07 13:33:08,775 [main_trainer.py:147] INFO Time per iteration including communication: 0.190461. computation: 0.112597. Speed: 168.013218 images/s, current density: 0.010000
2025-06-07 13:33:10,400 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:33:10,401 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016491,0.041809,0.001021,0.000000,0.000000
2025-06-07 13:33:12,166 [dl_trainer.py:876] INFO [  0][  260/  260][rank:0] loss: 2.015, average forward and backward time: 0.135048, iotime: 0.021462 
2025-06-07 13:33:12,172 [dl_trainer.py:882] INFO GPU memory usage memory_allocated: 511 MBytes, max_memory_allocated: 665 MBytes, memory_cached: 696 MBytes, max_memory_cached: 696 MBytes, CPU memory usage: 3098 MBytes
2025-06-07 13:33:12,225 [main_trainer.py:153] INFO Time per epoch including communication: 49.367412, 10.885081
2025-06-07 13:33:12,227 [dl_trainer.py:740] INFO train iter: 260, num_batches_per_epoch: 260
2025-06-07 13:33:12,228 [dl_trainer.py:743] INFO Epoch 0, avg train acc: 17.920673, lr: 0.025000, avg loss: 2.390497
2025-06-07 13:33:12,255 [dl_trainer.py:749] WARNING NaN detected! sparsities:  []
2025-06-07 13:33:12,256 [dl_trainer.py:751] INFO Average Sparsity: nan, compression ratio: nan, communication size: nan
2025-06-07 13:33:14,925 [dl_trainer.py:975] INFO Epoch 1, lr: 0.025000, val loss: 1.948381, val acc: 0.258800
2025-06-07 13:33:18,645 [main_trainer.py:147] INFO Time per iteration including communication: 0.198470. computation: 0.111099. Speed: 161.233117 images/s, current density: 0.010000
2025-06-07 13:33:22,089 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:33:22,090 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000083,0.016095,0.041680,0.001009,0.000000,0.000000
2025-06-07 13:33:22,281 [main_trainer.py:147] INFO Time per iteration including communication: 0.197359. computation: 0.110586. Speed: 162.141445 images/s, current density: 0.010000
2025-06-07 13:33:25,913 [main_trainer.py:147] INFO Time per iteration including communication: 0.196375. computation: 0.110166. Speed: 162.953824 images/s, current density: 0.010000
2025-06-07 13:33:29,530 [main_trainer.py:147] INFO Time per iteration including communication: 0.195461. computation: 0.109755. Speed: 163.715488 images/s, current density: 0.010000
2025-06-07 13:33:31,156 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:33:31,156 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016278,0.041615,0.000987,0.000000,0.000000
2025-06-07 13:33:33,160 [main_trainer.py:147] INFO Time per iteration including communication: 0.194683. computation: 0.109424. Speed: 164.369705 images/s, current density: 0.010000
2025-06-07 13:33:36,802 [main_trainer.py:147] INFO Time per iteration including communication: 0.194018. computation: 0.109135. Speed: 164.933266 images/s, current density: 0.010000
2025-06-07 13:33:40,249 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:33:40,249 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016115,0.041388,0.000949,0.000000,0.000000
2025-06-07 13:33:40,441 [main_trainer.py:147] INFO Time per iteration including communication: 0.193414. computation: 0.108896. Speed: 165.448236 images/s, current density: 0.010000
2025-06-07 13:33:44,069 [main_trainer.py:147] INFO Time per iteration including communication: 0.192839. computation: 0.108670. Speed: 165.941245 images/s, current density: 0.010000
2025-06-07 13:33:47,695 [main_trainer.py:147] INFO Time per iteration including communication: 0.192315. computation: 0.108448. Speed: 166.393927 images/s, current density: 0.010000
2025-06-07 13:33:49,324 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:33:49,324 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016408,0.041646,0.000968,0.000000,0.000000
2025-06-07 13:33:51,335 [main_trainer.py:147] INFO Time per iteration including communication: 0.191864. computation: 0.108259. Speed: 166.784532 images/s, current density: 0.010000
2025-06-07 13:33:54,961 [main_trainer.py:147] INFO Time per iteration including communication: 0.191423. computation: 0.108076. Speed: 167.169218 images/s, current density: 0.010000
2025-06-07 13:33:58,410 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:33:58,410 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016751,0.041925,0.001010,0.000000,0.000000
2025-06-07 13:33:58,601 [main_trainer.py:147] INFO Time per iteration including communication: 0.191045. computation: 0.107943. Speed: 167.499589 images/s, current density: 0.010000
2025-06-07 13:34:02,002 [dl_trainer.py:876] INFO [  1][  520/  260][rank:0] loss: 1.299, average forward and backward time: 0.136709, iotime: 0.021240 
2025-06-07 13:34:02,007 [dl_trainer.py:882] INFO GPU memory usage memory_allocated: 511 MBytes, max_memory_allocated: 744 MBytes, memory_cached: 782 MBytes, max_memory_cached: 782 MBytes, CPU memory usage: 3100 MBytes
2025-06-07 13:34:02,066 [main_trainer.py:153] INFO Time per epoch including communication: 47.140923, 21.706923
2025-06-07 13:34:02,068 [dl_trainer.py:740] INFO train iter: 520, num_batches_per_epoch: 260
2025-06-07 13:34:02,069 [dl_trainer.py:743] INFO Epoch 1, avg train acc: 31.911058, lr: 0.033333, avg loss: 1.804768
2025-06-07 13:34:02,070 [dl_trainer.py:749] WARNING NaN detected! sparsities:  []
2025-06-07 13:34:02,070 [dl_trainer.py:751] INFO Average Sparsity: nan, compression ratio: nan, communication size: nan
2025-06-07 13:34:04,883 [dl_trainer.py:975] INFO Epoch 2, lr: 0.033333, val loss: 1.679334, val acc: 0.368600
2025-06-07 13:34:08,602 [main_trainer.py:147] INFO Time per iteration including communication: 0.195401. computation: 0.107525. Speed: 163.765490 images/s, current density: 0.010000
2025-06-07 13:34:10,226 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:34:10,227 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.015966,0.041191,0.001009,0.000000,0.000000
2025-06-07 13:34:12,235 [main_trainer.py:147] INFO Time per iteration including communication: 0.194909. computation: 0.107396. Speed: 164.179138 images/s, current density: 0.010000
2025-06-07 13:34:15,875 [main_trainer.py:147] INFO Time per iteration including communication: 0.194463. computation: 0.107279. Speed: 164.556086 images/s, current density: 0.010000
2025-06-07 13:34:19,316 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:34:19,317 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016397,0.041485,0.000931,0.000000,0.000000
2025-06-07 13:34:19,509 [main_trainer.py:147] INFO Time per iteration including communication: 0.194036. computation: 0.107169. Speed: 164.918246 images/s, current density: 0.010000
2025-06-07 13:34:23,124 [main_trainer.py:147] INFO Time per iteration including communication: 0.193606. computation: 0.107064. Speed: 165.284434 images/s, current density: 0.010000
2025-06-07 13:34:26,753 [main_trainer.py:147] INFO Time per iteration including communication: 0.193224. computation: 0.106948. Speed: 165.610524 images/s, current density: 0.010000
2025-06-07 13:34:28,380 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:34:28,380 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.015859,0.041815,0.000960,0.000000,0.000000
2025-06-07 13:34:30,385 [main_trainer.py:147] INFO Time per iteration including communication: 0.192871. computation: 0.106852. Speed: 165.913749 images/s, current density: 0.010000
2025-06-07 13:41:45,606 [main_trainer.py:279] INFO Configurations: Namespace(batch_size=32, nsteps_update=1, nworkers=6, nwpernode=1, compression=True, compressor='spardl', sigma_scale=2.5, density=0.01, dataset='cifar10', dnn='vgg16', data_dir='./vgg_data', lr=0.1, max_epochs=121, pretrain=None)
2025-06-07 13:41:45,606 [main_trainer.py:281] INFO Interpreter: 3.9.16 (main, Mar  1 2023, 18:22:10) 
[GCC 11.2.0]
2025-06-07 13:41:49,445 [dl_trainer.py:280] INFO target_sparsities: [1.0]
2025-06-07 13:41:49,445 [dl_trainer.py:290] INFO num_batches_per_epoch: 260
2025-06-07 13:41:49,446 [main_trainer.py:81] INFO Broadcast parameters....
2025-06-07 13:41:49,689 [main_trainer.py:96] INFO Broadcast parameters finished....
2025-06-07 13:41:49,693 [allreducer.py:281] INFO density: 0.010000
2025-06-07 13:41:49,694 [allreducer.py:282] INFO threshold scale: 1.092000
2025-06-07 13:41:49,694 [allreducer.py:663] INFO groups: [['fc.bias', 'fc.weight', 'features.41.bias', 'features.41.weight', 'features.40.bias', 'features.40.weight', 'features.38.bias', 'features.38.weight', 'features.37.bias', 'features.37.weight', 'features.35.bias', 'features.35.weight', 'features.34.bias', 'features.34.weight', 'features.31.bias', 'features.31.weight', 'features.30.bias', 'features.30.weight', 'features.28.bias', 'features.28.weight', 'features.27.bias', 'features.27.weight', 'features.25.bias', 'features.25.weight', 'features.24.bias', 'features.24.weight', 'features.21.bias', 'features.21.weight', 'features.20.bias', 'features.20.weight', 'features.18.bias', 'features.18.weight', 'features.17.bias', 'features.17.weight', 'features.15.bias', 'features.15.weight', 'features.14.bias', 'features.14.weight', 'features.11.bias', 'features.11.weight', 'features.10.bias', 'features.10.weight', 'features.8.bias', 'features.8.weight', 'features.7.bias', 'features.7.weight', 'features.4.bias', 'features.4.weight', 'features.3.bias', 'features.3.weight', 'features.1.bias', 'features.1.weight', 'features.0.bias', 'features.0.weight']]
2025-06-07 13:41:49,694 [allreducer.py:664] INFO key_groupidx_maps: {'fc.bias': 0, 'fc.weight': 0, 'features.41.bias': 0, 'features.41.weight': 0, 'features.40.bias': 0, 'features.40.weight': 0, 'features.38.bias': 0, 'features.38.weight': 0, 'features.37.bias': 0, 'features.37.weight': 0, 'features.35.bias': 0, 'features.35.weight': 0, 'features.34.bias': 0, 'features.34.weight': 0, 'features.31.bias': 0, 'features.31.weight': 0, 'features.30.bias': 0, 'features.30.weight': 0, 'features.28.bias': 0, 'features.28.weight': 0, 'features.27.bias': 0, 'features.27.weight': 0, 'features.25.bias': 0, 'features.25.weight': 0, 'features.24.bias': 0, 'features.24.weight': 0, 'features.21.bias': 0, 'features.21.weight': 0, 'features.20.bias': 0, 'features.20.weight': 0, 'features.18.bias': 0, 'features.18.weight': 0, 'features.17.bias': 0, 'features.17.weight': 0, 'features.15.bias': 0, 'features.15.weight': 0, 'features.14.bias': 0, 'features.14.weight': 0, 'features.11.bias': 0, 'features.11.weight': 0, 'features.10.bias': 0, 'features.10.weight': 0, 'features.8.bias': 0, 'features.8.weight': 0, 'features.7.bias': 0, 'features.7.weight': 0, 'features.4.bias': 0, 'features.4.weight': 0, 'features.3.bias': 0, 'features.3.weight': 0, 'features.1.bias': 0, 'features.1.weight': 0, 'features.0.bias': 0, 'features.0.weight': 0}
2025-06-07 13:41:49,695 [allreducer.py:696] INFO offsets: 
2025-06-07 13:41:49,695 [allreducer.py:343] INFO dynamic densities = [0.01]
2025-06-07 13:41:49,698 [allreducer.py:655] INFO spar_groups: [{'features.0.weight': ((0, 1728), (0, 1728)), 'features.0.bias': ((0, 64), (1728, 1792)), 'features.1.weight': ((0, 64), (1792, 1856)), 'features.1.bias': ((0, 64), (1856, 1920)), 'features.3.weight': ((0, 36864), (1920, 38784)), 'features.3.bias': ((0, 64), (38784, 38848)), 'features.4.weight': ((0, 64), (38848, 38912)), 'features.4.bias': ((0, 64), (38912, 38976)), 'features.7.weight': ((0, 73728), (38976, 112704)), 'features.7.bias': ((0, 128), (112704, 112832)), 'features.8.weight': ((0, 128), (112832, 112960)), 'features.8.bias': ((0, 128), (112960, 113088)), 'features.10.weight': ((0, 147456), (113088, 260544)), 'features.10.bias': ((0, 128), (260544, 260672)), 'features.11.weight': ((0, 128), (260672, 260800)), 'features.11.bias': ((0, 128), (260800, 260928)), 'features.14.weight': ((0, 294912), (260928, 555840)), 'features.14.bias': ((0, 256), (555840, 556096)), 'features.15.weight': ((0, 256), (556096, 556352)), 'features.15.bias': ((0, 256), (556352, 556608)), 'features.17.weight': ((0, 589824), (556608, 1146432)), 'features.17.bias': ((0, 256), (1146432, 1146688)), 'features.18.weight': ((0, 256), (1146688, 1146944)), 'features.18.bias': ((0, 256), (1146944, 1147200)), 'features.20.weight': ((0, 589824), (1147200, 1737024)), 'features.20.bias': ((0, 256), (1737024, 1737280)), 'features.21.weight': ((0, 256), (1737280, 1737536)), 'features.21.bias': ((0, 256), (1737536, 1737792)), 'features.24.weight': ((0, 716919), (1737792, 2454711))}, {'features.24.weight': ((716919, 1179648), (0, 462729)), 'features.24.bias': ((0, 512), (462729, 463241)), 'features.25.weight': ((0, 512), (463241, 463753)), 'features.25.bias': ((0, 512), (463753, 464265)), 'features.27.weight': ((0, 1990446), (464265, 2454711))}, {'features.27.weight': ((1990446, 2359296), (0, 368850)), 'features.27.bias': ((0, 512), (368850, 369362)), 'features.28.weight': ((0, 512), (369362, 369874)), 'features.28.bias': ((0, 512), (369874, 370386)), 'features.30.weight': ((0, 2084325), (370386, 2454711))}, {'features.30.weight': ((2084325, 2359296), (0, 274971)), 'features.30.bias': ((0, 512), (274971, 275483)), 'features.31.weight': ((0, 512), (275483, 275995)), 'features.31.bias': ((0, 512), (275995, 276507)), 'features.34.weight': ((0, 2178204), (276507, 2454711))}, {'features.34.weight': ((2178204, 2359296), (0, 181092)), 'features.34.bias': ((0, 512), (181092, 181604)), 'features.35.weight': ((0, 512), (181604, 182116)), 'features.35.bias': ((0, 512), (182116, 182628)), 'features.37.weight': ((0, 2272083), (182628, 2454711))}, {'features.37.weight': ((2272083, 2359296), (0, 87213)), 'features.37.bias': ((0, 512), (87213, 87725)), 'features.38.weight': ((0, 512), (87725, 88237)), 'features.38.bias': ((0, 512), (88237, 88749)), 'features.40.weight': ((0, 2359296), (88749, 2448045)), 'features.40.bias': ((0, 512), (2448045, 2448557)), 'features.41.weight': ((0, 512), (2448557, 2449069)), 'features.41.bias': ((0, 512), (2449069, 2449581)), 'fc.weight': ((0, 5120), (2449581, 2454701)), 'fc.bias': ((0, 10), (2454701, 2454711))}]
2025-06-07 13:41:49,698 [allreducer.py:656] INFO spar_key_groupidx_maps: {'features.0.weight': [0], 'features.0.bias': [0], 'features.1.weight': [0], 'features.1.bias': [0], 'features.3.weight': [0], 'features.3.bias': [0], 'features.4.weight': [0], 'features.4.bias': [0], 'features.7.weight': [0], 'features.7.bias': [0], 'features.8.weight': [0], 'features.8.bias': [0], 'features.10.weight': [0], 'features.10.bias': [0], 'features.11.weight': [0], 'features.11.bias': [0], 'features.14.weight': [0], 'features.14.bias': [0], 'features.15.weight': [0], 'features.15.bias': [0], 'features.17.weight': [0], 'features.17.bias': [0], 'features.18.weight': [0], 'features.18.bias': [0], 'features.20.weight': [0], 'features.20.bias': [0], 'features.21.weight': [0], 'features.21.bias': [0], 'features.24.weight': [0, 1], 'features.24.bias': [1], 'features.25.weight': [1], 'features.25.bias': [1], 'features.27.weight': [1, 2], 'features.27.bias': [2], 'features.28.weight': [2], 'features.28.bias': [2], 'features.30.weight': [2, 3], 'features.30.bias': [3], 'features.31.weight': [3], 'features.31.bias': [3], 'features.34.weight': [3, 4], 'features.34.bias': [4], 'features.35.weight': [4], 'features.35.bias': [4], 'features.37.weight': [4, 5], 'features.37.bias': [5], 'features.38.weight': [5], 'features.38.bias': [5], 'features.40.weight': [5], 'features.40.bias': [5], 'features.41.weight': [5], 'features.41.bias': [5], 'fc.weight': [5], 'fc.bias': [5]}
2025-06-07 13:41:49,705 [allreducer.py:972] INFO Allreducer thread started ...
2025-06-07 13:41:49,705 [main_trainer.py:119] INFO Start training ....
2025-06-07 13:41:55,591 [main_trainer.py:147] INFO Time per iteration including communication: 0.280219. computation: 0.202057. Speed: 114.196360 images/s, current density: 0.010000
2025-06-07 13:41:59,228 [main_trainer.py:147] INFO Time per iteration including communication: 0.232214. computation: 0.154167. Speed: 137.803762 images/s, current density: 0.010000
2025-06-07 13:42:00,859 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:42:00,860 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000083,0.016485,0.042207,0.001023,0.000000,0.000000
2025-06-07 13:42:02,862 [main_trainer.py:147] INFO Time per iteration including communication: 0.215629. computation: 0.137518. Speed: 148.403047 images/s, current density: 0.010000
2025-06-07 13:42:06,502 [main_trainer.py:147] INFO Time per iteration including communication: 0.207306. computation: 0.129254. Speed: 154.361412 images/s, current density: 0.010000
2025-06-07 13:42:09,953 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:42:09,954 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016124,0.041478,0.001014,0.000000,0.000000
2025-06-07 13:42:10,144 [main_trainer.py:147] INFO Time per iteration including communication: 0.202307. computation: 0.124182. Speed: 158.175559 images/s, current density: 0.010000
2025-06-07 13:42:13,783 [main_trainer.py:147] INFO Time per iteration including communication: 0.198934. computation: 0.120731. Speed: 160.857762 images/s, current density: 0.010000
2025-06-07 13:42:17,426 [main_trainer.py:147] INFO Time per iteration including communication: 0.196543. computation: 0.118278. Speed: 162.814185 images/s, current density: 0.010000
2025-06-07 13:42:19,057 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:42:19,057 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016052,0.041495,0.000987,0.000000,0.000000
2025-06-07 13:42:21,069 [main_trainer.py:147] INFO Time per iteration including communication: 0.194751. computation: 0.116480. Speed: 164.312222 images/s, current density: 0.010000
2025-06-07 13:42:24,709 [main_trainer.py:147] INFO Time per iteration including communication: 0.193337. computation: 0.115137. Speed: 165.513774 images/s, current density: 0.010000
2025-06-07 13:42:28,155 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:42:28,155 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016244,0.041767,0.000976,0.000000,0.000000
2025-06-07 13:42:28,347 [main_trainer.py:147] INFO Time per iteration including communication: 0.192195. computation: 0.114087. Speed: 166.497189 images/s, current density: 0.010000
2025-06-07 13:42:31,988 [main_trainer.py:147] INFO Time per iteration including communication: 0.191271. computation: 0.113189. Speed: 167.301914 images/s, current density: 0.010000
2025-06-07 13:42:35,627 [main_trainer.py:147] INFO Time per iteration including communication: 0.190492. computation: 0.112433. Speed: 167.985766 images/s, current density: 0.010000
2025-06-07 13:42:37,254 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:42:37,254 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016252,0.041781,0.000972,0.000000,0.000000
2025-06-07 13:42:39,029 [dl_trainer.py:876] INFO [  0][  260/  260][rank:0] loss: 2.015, average forward and backward time: 0.134850, iotime: 0.021563 
2025-06-07 13:42:39,034 [dl_trainer.py:882] INFO GPU memory usage memory_allocated: 511 MBytes, max_memory_allocated: 665 MBytes, memory_cached: 696 MBytes, max_memory_cached: 696 MBytes, CPU memory usage: 3119 MBytes
2025-06-07 13:42:39,087 [main_trainer.py:153] INFO Time per epoch including communication: 49.381387, 10.847526
2025-06-07 13:42:39,089 [dl_trainer.py:740] INFO train iter: 260, num_batches_per_epoch: 260
2025-06-07 13:42:39,090 [dl_trainer.py:743] INFO Epoch 0, avg train acc: 17.920673, lr: 0.025000, avg loss: 2.390497
2025-06-07 13:42:39,092 [dl_trainer.py:749] WARNING NaN detected! sparsities:  []
2025-06-07 13:42:39,092 [dl_trainer.py:751] INFO Average Sparsity: nan, compression ratio: nan, communication size: nan
2025-06-07 13:42:41,894 [dl_trainer.py:975] INFO Epoch 1, lr: 0.025000, val loss: 1.948381, val acc: 0.258800
2025-06-07 13:42:45,616 [main_trainer.py:147] INFO Time per iteration including communication: 0.198920. computation: 0.110909. Speed: 160.868562 images/s, current density: 0.010000
2025-06-07 13:42:49,061 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:42:49,061 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016452,0.041511,0.001028,0.000000,0.000000
2025-06-07 13:42:49,252 [main_trainer.py:147] INFO Time per iteration including communication: 0.197781. computation: 0.110391. Speed: 161.795016 images/s, current density: 0.010000
2025-06-07 13:42:52,895 [main_trainer.py:147] INFO Time per iteration including communication: 0.196803. computation: 0.109953. Speed: 162.599042 images/s, current density: 0.010000
2025-06-07 13:42:56,534 [main_trainer.py:147] INFO Time per iteration including communication: 0.195930. computation: 0.109553. Speed: 163.323685 images/s, current density: 0.010000
2025-06-07 13:42:58,163 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:42:58,163 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016021,0.041490,0.001003,0.000000,0.000000
2025-06-07 13:43:00,167 [main_trainer.py:147] INFO Time per iteration including communication: 0.195134. computation: 0.109232. Speed: 163.989905 images/s, current density: 0.010000
2025-06-07 13:43:03,793 [main_trainer.py:147] INFO Time per iteration including communication: 0.194404. computation: 0.108924. Speed: 164.605632 images/s, current density: 0.010000
2025-06-07 13:43:07,232 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:43:07,232 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016775,0.041979,0.001053,0.000000,0.000000
2025-06-07 13:43:07,422 [main_trainer.py:147] INFO Time per iteration including communication: 0.193756. computation: 0.108660. Speed: 165.156098 images/s, current density: 0.010000
2025-06-07 13:43:11,054 [main_trainer.py:147] INFO Time per iteration including communication: 0.193175. computation: 0.108419. Speed: 165.652902 images/s, current density: 0.010000
2025-06-07 13:43:14,691 [main_trainer.py:147] INFO Time per iteration including communication: 0.192659. computation: 0.108207. Speed: 166.096406 images/s, current density: 0.010000
2025-06-07 13:43:16,321 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:43:16,321 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.016199,0.041972,0.001052,0.000000,0.000000
2025-06-07 13:43:18,334 [main_trainer.py:147] INFO Time per iteration including communication: 0.192202. computation: 0.108020. Speed: 166.491246 images/s, current density: 0.010000
2025-06-07 13:43:21,967 [main_trainer.py:147] INFO Time per iteration including communication: 0.191760. computation: 0.107797. Speed: 166.875138 images/s, current density: 0.010000
2025-06-07 13:43:25,408 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:43:25,409 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016164,0.042087,0.001000,0.000000,0.000000
2025-06-07 13:43:25,599 [main_trainer.py:147] INFO Time per iteration including communication: 0.191352. computation: 0.107625. Speed: 167.231299 images/s, current density: 0.010000
2025-06-07 13:43:29,002 [dl_trainer.py:876] INFO [  1][  520/  260][rank:0] loss: 1.299, average forward and backward time: 0.137120, iotime: 0.021809 
2025-06-07 13:43:29,006 [dl_trainer.py:882] INFO GPU memory usage memory_allocated: 511 MBytes, max_memory_allocated: 744 MBytes, memory_cached: 782 MBytes, max_memory_cached: 782 MBytes, CPU memory usage: 3120 MBytes
2025-06-07 13:43:29,061 [main_trainer.py:153] INFO Time per epoch including communication: 47.167462, 21.713140
2025-06-07 13:43:29,063 [dl_trainer.py:740] INFO train iter: 520, num_batches_per_epoch: 260
2025-06-07 13:43:29,064 [dl_trainer.py:743] INFO Epoch 1, avg train acc: 31.911058, lr: 0.033333, avg loss: 1.804768
2025-06-07 13:43:29,064 [dl_trainer.py:749] WARNING NaN detected! sparsities:  []
2025-06-07 13:43:29,065 [dl_trainer.py:751] INFO Average Sparsity: nan, compression ratio: nan, communication size: nan
2025-06-07 13:43:31,836 [dl_trainer.py:975] INFO Epoch 2, lr: 0.033333, val loss: 1.679334, val acc: 0.368600
2025-06-07 13:43:35,560 [main_trainer.py:147] INFO Time per iteration including communication: 0.195611. computation: 0.107137. Speed: 163.589995 images/s, current density: 0.010000
2025-06-07 13:43:37,187 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:43:37,188 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.015975,0.041444,0.001030,0.000000,0.000000
2025-06-07 13:43:39,199 [main_trainer.py:147] INFO Time per iteration including communication: 0.195122. computation: 0.106989. Speed: 163.999966 images/s, current density: 0.010000
2025-06-07 13:43:42,829 [main_trainer.py:147] INFO Time per iteration including communication: 0.194652. computation: 0.106854. Speed: 164.396201 images/s, current density: 0.010000
2025-06-07 13:43:46,267 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:43:46,268 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016311,0.041791,0.001039,0.000000,0.000000
2025-06-07 13:43:46,459 [main_trainer.py:147] INFO Time per iteration including communication: 0.194212. computation: 0.106741. Speed: 164.768595 images/s, current density: 0.010000
2025-06-07 13:43:50,089 [main_trainer.py:147] INFO Time per iteration including communication: 0.193799. computation: 0.106644. Speed: 165.119418 images/s, current density: 0.010000
2025-06-07 13:43:53,718 [main_trainer.py:147] INFO Time per iteration including communication: 0.193414. computation: 0.106549. Speed: 165.448635 images/s, current density: 0.010000
2025-06-07 13:43:55,341 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:43:55,342 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.016417,0.042104,0.001054,0.000000,0.000000
2025-06-07 13:43:57,351 [main_trainer.py:147] INFO Time per iteration including communication: 0.193054. computation: 0.106448. Speed: 165.756493 images/s, current density: 0.010000
2025-06-07 13:44:00,994 [main_trainer.py:147] INFO Time per iteration including communication: 0.192733. computation: 0.106369. Speed: 166.033191 images/s, current density: 0.010000
2025-06-07 13:44:04,443 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:44:04,443 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016245,0.041484,0.001012,0.000000,0.000000
2025-06-07 13:44:04,633 [main_trainer.py:147] INFO Time per iteration including communication: 0.192424. computation: 0.106291. Speed: 166.299332 images/s, current density: 0.010000
2025-06-07 13:44:08,263 [main_trainer.py:147] INFO Time per iteration including communication: 0.192118. computation: 0.106220. Speed: 166.563933 images/s, current density: 0.010000
2025-06-07 13:44:11,891 [main_trainer.py:147] INFO Time per iteration including communication: 0.191827. computation: 0.106158. Speed: 166.816679 images/s, current density: 0.010000
2025-06-07 13:44:13,516 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:44:13,516 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016677,0.042044,0.001041,0.000000,0.000000
2025-06-07 13:44:15,530 [main_trainer.py:147] INFO Time per iteration including communication: 0.191567. computation: 0.106098. Speed: 167.043637 images/s, current density: 0.010000
2025-06-07 13:44:18,931 [dl_trainer.py:876] INFO [  2][  780/  260][rank:0] loss: 1.292, average forward and backward time: 0.137051, iotime: 0.021710 
2025-06-07 13:44:18,934 [dl_trainer.py:882] INFO GPU memory usage memory_allocated: 511 MBytes, max_memory_allocated: 744 MBytes, memory_cached: 782 MBytes, max_memory_cached: 782 MBytes, CPU memory usage: 3121 MBytes
2025-06-07 13:44:18,992 [main_trainer.py:153] INFO Time per epoch including communication: 47.156053, 32.571795
2025-06-07 13:44:18,994 [dl_trainer.py:740] INFO train iter: 780, num_batches_per_epoch: 260
2025-06-07 13:44:18,995 [dl_trainer.py:743] INFO Epoch 2, avg train acc: 40.384617, lr: 0.041667, avg loss: 1.609514
2025-06-07 13:44:18,996 [dl_trainer.py:749] WARNING NaN detected! sparsities:  []
2025-06-07 13:44:18,996 [dl_trainer.py:751] INFO Average Sparsity: nan, compression ratio: nan, communication size: nan
2025-06-07 13:44:21,764 [dl_trainer.py:975] INFO Epoch 3, lr: 0.041667, val loss: 1.801276, val acc: 0.363700
2025-06-07 13:44:25,290 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:44:25,290 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000082,0.016084,0.041452,0.001058,0.000000,0.000000
2025-06-07 13:44:25,482 [main_trainer.py:147] INFO Time per iteration including communication: 0.194423. computation: 0.105889. Speed: 164.589810 images/s, current density: 0.010000
2025-06-07 13:44:29,120 [main_trainer.py:147] INFO Time per iteration including communication: 0.194116. computation: 0.105846. Speed: 164.849624 images/s, current density: 0.010000
2025-06-07 13:44:32,758 [main_trainer.py:147] INFO Time per iteration including communication: 0.193824. computation: 0.105813. Speed: 165.098351 images/s, current density: 0.010000
2025-06-07 13:44:34,380 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:44:34,380 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016210,0.041729,0.000989,0.000000,0.000000
2025-06-07 13:44:36,394 [main_trainer.py:147] INFO Time per iteration including communication: 0.193543. computation: 0.105778. Speed: 165.338003 images/s, current density: 0.010000
2025-06-07 13:44:40,033 [main_trainer.py:147] INFO Time per iteration including communication: 0.193278. computation: 0.105738. Speed: 165.564792 images/s, current density: 0.010000
2025-06-07 13:44:43,479 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:44:43,479 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016676,0.041620,0.000992,0.000000,0.000000
2025-06-07 13:44:43,671 [main_trainer.py:147] INFO Time per iteration including communication: 0.193023. computation: 0.105695. Speed: 165.783138 images/s, current density: 0.010000
2025-06-07 13:44:47,303 [main_trainer.py:147] INFO Time per iteration including communication: 0.192774. computation: 0.105651. Speed: 165.997895 images/s, current density: 0.010000
2025-06-07 13:44:50,939 [main_trainer.py:147] INFO Time per iteration including communication: 0.192539. computation: 0.105621. Speed: 166.200200 images/s, current density: 0.010000
2025-06-07 13:44:52,568 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:44:52,568 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000081,0.016283,0.041623,0.001010,0.000000,0.000000
2025-06-07 13:44:54,581 [main_trainer.py:147] INFO Time per iteration including communication: 0.192320. computation: 0.105573. Speed: 166.389599 images/s, current density: 0.010000
2025-06-07 13:44:58,223 [main_trainer.py:147] INFO Time per iteration including communication: 0.192110. computation: 0.105530. Speed: 166.571041 images/s, current density: 0.010000
2025-06-07 13:45:01,656 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-07 13:45:01,656 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000080,0.016361,0.042415,0.001010,0.000000,0.000000
2025-06-07 13:45:01,848 [main_trainer.py:147] INFO Time per iteration including communication: 0.191892. computation: 0.105465. Speed: 166.760501 images/s, current density: 0.010000
2025-06-07 13:45:05,467 [main_trainer.py:147] INFO Time per iteration including communication: 0.191676. computation: 0.105430. Speed: 166.948371 images/s, current density: 0.010000
2025-06-08 08:25:01,669 [main_trainer.py:294] INFO Configurations: Namespace(batch_size=32, nsteps_update=1, nworkers=6, nwpernode=1, compression=True, compressor='spardl', sigma_scale=2.5, density=0.01, dataset='cifar10', dnn='vgg16', data_dir='./vgg_data', lr=0.1, max_epochs=121, pretrain=None)
2025-06-08 08:25:01,669 [main_trainer.py:300] INFO Interpreter: 3.9.16 (main, Mar  1 2023, 18:22:10) 
[GCC 11.2.0]
2025-06-08 08:25:06,386 [dl_trainer.py:292] INFO target_sparsities: [1.0]
2025-06-08 08:25:06,386 [dl_trainer.py:302] INFO num_batches_per_epoch: 260
2025-06-08 08:25:06,387 [main_trainer.py:88] INFO Broadcast parameters....
2025-06-08 08:25:06,634 [main_trainer.py:107] INFO Broadcast parameters finished....
2025-06-08 08:25:06,642 [allreducer.py:281] INFO density: 0.010000
2025-06-08 08:25:06,642 [allreducer.py:282] INFO threshold scale: 1.092000
2025-06-08 08:25:06,643 [allreducer.py:663] INFO groups: [['fc.bias', 'fc.weight', 'features.41.bias', 'features.41.weight', 'features.40.bias', 'features.40.weight', 'features.38.bias', 'features.38.weight', 'features.37.bias', 'features.37.weight', 'features.35.bias', 'features.35.weight', 'features.34.bias', 'features.34.weight', 'features.31.bias', 'features.31.weight', 'features.30.bias', 'features.30.weight', 'features.28.bias', 'features.28.weight', 'features.27.bias', 'features.27.weight', 'features.25.bias', 'features.25.weight', 'features.24.bias', 'features.24.weight', 'features.21.bias', 'features.21.weight', 'features.20.bias', 'features.20.weight', 'features.18.bias', 'features.18.weight', 'features.17.bias', 'features.17.weight', 'features.15.bias', 'features.15.weight', 'features.14.bias', 'features.14.weight', 'features.11.bias', 'features.11.weight', 'features.10.bias', 'features.10.weight', 'features.8.bias', 'features.8.weight', 'features.7.bias', 'features.7.weight', 'features.4.bias', 'features.4.weight', 'features.3.bias', 'features.3.weight', 'features.1.bias', 'features.1.weight', 'features.0.bias', 'features.0.weight']]
2025-06-08 08:25:06,643 [allreducer.py:664] INFO key_groupidx_maps: {'fc.bias': 0, 'fc.weight': 0, 'features.41.bias': 0, 'features.41.weight': 0, 'features.40.bias': 0, 'features.40.weight': 0, 'features.38.bias': 0, 'features.38.weight': 0, 'features.37.bias': 0, 'features.37.weight': 0, 'features.35.bias': 0, 'features.35.weight': 0, 'features.34.bias': 0, 'features.34.weight': 0, 'features.31.bias': 0, 'features.31.weight': 0, 'features.30.bias': 0, 'features.30.weight': 0, 'features.28.bias': 0, 'features.28.weight': 0, 'features.27.bias': 0, 'features.27.weight': 0, 'features.25.bias': 0, 'features.25.weight': 0, 'features.24.bias': 0, 'features.24.weight': 0, 'features.21.bias': 0, 'features.21.weight': 0, 'features.20.bias': 0, 'features.20.weight': 0, 'features.18.bias': 0, 'features.18.weight': 0, 'features.17.bias': 0, 'features.17.weight': 0, 'features.15.bias': 0, 'features.15.weight': 0, 'features.14.bias': 0, 'features.14.weight': 0, 'features.11.bias': 0, 'features.11.weight': 0, 'features.10.bias': 0, 'features.10.weight': 0, 'features.8.bias': 0, 'features.8.weight': 0, 'features.7.bias': 0, 'features.7.weight': 0, 'features.4.bias': 0, 'features.4.weight': 0, 'features.3.bias': 0, 'features.3.weight': 0, 'features.1.bias': 0, 'features.1.weight': 0, 'features.0.bias': 0, 'features.0.weight': 0}
2025-06-08 08:25:06,643 [allreducer.py:696] INFO offsets: 
2025-06-08 08:25:06,643 [allreducer.py:343] INFO dynamic densities = [0.01]
2025-06-08 08:25:06,646 [allreducer.py:655] INFO spar_groups: [{'features.0.weight': ((0, 1728), (0, 1728)), 'features.0.bias': ((0, 64), (1728, 1792)), 'features.1.weight': ((0, 64), (1792, 1856)), 'features.1.bias': ((0, 64), (1856, 1920)), 'features.3.weight': ((0, 36864), (1920, 38784)), 'features.3.bias': ((0, 64), (38784, 38848)), 'features.4.weight': ((0, 64), (38848, 38912)), 'features.4.bias': ((0, 64), (38912, 38976)), 'features.7.weight': ((0, 73728), (38976, 112704)), 'features.7.bias': ((0, 128), (112704, 112832)), 'features.8.weight': ((0, 128), (112832, 112960)), 'features.8.bias': ((0, 128), (112960, 113088)), 'features.10.weight': ((0, 147456), (113088, 260544)), 'features.10.bias': ((0, 128), (260544, 260672)), 'features.11.weight': ((0, 128), (260672, 260800)), 'features.11.bias': ((0, 128), (260800, 260928)), 'features.14.weight': ((0, 294912), (260928, 555840)), 'features.14.bias': ((0, 256), (555840, 556096)), 'features.15.weight': ((0, 256), (556096, 556352)), 'features.15.bias': ((0, 256), (556352, 556608)), 'features.17.weight': ((0, 589824), (556608, 1146432)), 'features.17.bias': ((0, 256), (1146432, 1146688)), 'features.18.weight': ((0, 256), (1146688, 1146944)), 'features.18.bias': ((0, 256), (1146944, 1147200)), 'features.20.weight': ((0, 589824), (1147200, 1737024)), 'features.20.bias': ((0, 256), (1737024, 1737280)), 'features.21.weight': ((0, 256), (1737280, 1737536)), 'features.21.bias': ((0, 256), (1737536, 1737792)), 'features.24.weight': ((0, 716919), (1737792, 2454711))}, {'features.24.weight': ((716919, 1179648), (0, 462729)), 'features.24.bias': ((0, 512), (462729, 463241)), 'features.25.weight': ((0, 512), (463241, 463753)), 'features.25.bias': ((0, 512), (463753, 464265)), 'features.27.weight': ((0, 1990446), (464265, 2454711))}, {'features.27.weight': ((1990446, 2359296), (0, 368850)), 'features.27.bias': ((0, 512), (368850, 369362)), 'features.28.weight': ((0, 512), (369362, 369874)), 'features.28.bias': ((0, 512), (369874, 370386)), 'features.30.weight': ((0, 2084325), (370386, 2454711))}, {'features.30.weight': ((2084325, 2359296), (0, 274971)), 'features.30.bias': ((0, 512), (274971, 275483)), 'features.31.weight': ((0, 512), (275483, 275995)), 'features.31.bias': ((0, 512), (275995, 276507)), 'features.34.weight': ((0, 2178204), (276507, 2454711))}, {'features.34.weight': ((2178204, 2359296), (0, 181092)), 'features.34.bias': ((0, 512), (181092, 181604)), 'features.35.weight': ((0, 512), (181604, 182116)), 'features.35.bias': ((0, 512), (182116, 182628)), 'features.37.weight': ((0, 2272083), (182628, 2454711))}, {'features.37.weight': ((2272083, 2359296), (0, 87213)), 'features.37.bias': ((0, 512), (87213, 87725)), 'features.38.weight': ((0, 512), (87725, 88237)), 'features.38.bias': ((0, 512), (88237, 88749)), 'features.40.weight': ((0, 2359296), (88749, 2448045)), 'features.40.bias': ((0, 512), (2448045, 2448557)), 'features.41.weight': ((0, 512), (2448557, 2449069)), 'features.41.bias': ((0, 512), (2449069, 2449581)), 'fc.weight': ((0, 5120), (2449581, 2454701)), 'fc.bias': ((0, 10), (2454701, 2454711))}]
2025-06-08 08:25:06,646 [allreducer.py:656] INFO spar_key_groupidx_maps: {'features.0.weight': [0], 'features.0.bias': [0], 'features.1.weight': [0], 'features.1.bias': [0], 'features.3.weight': [0], 'features.3.bias': [0], 'features.4.weight': [0], 'features.4.bias': [0], 'features.7.weight': [0], 'features.7.bias': [0], 'features.8.weight': [0], 'features.8.bias': [0], 'features.10.weight': [0], 'features.10.bias': [0], 'features.11.weight': [0], 'features.11.bias': [0], 'features.14.weight': [0], 'features.14.bias': [0], 'features.15.weight': [0], 'features.15.bias': [0], 'features.17.weight': [0], 'features.17.bias': [0], 'features.18.weight': [0], 'features.18.bias': [0], 'features.20.weight': [0], 'features.20.bias': [0], 'features.21.weight': [0], 'features.21.bias': [0], 'features.24.weight': [0, 1], 'features.24.bias': [1], 'features.25.weight': [1], 'features.25.bias': [1], 'features.27.weight': [1, 2], 'features.27.bias': [2], 'features.28.weight': [2], 'features.28.bias': [2], 'features.30.weight': [2, 3], 'features.30.bias': [3], 'features.31.weight': [3], 'features.31.bias': [3], 'features.34.weight': [3, 4], 'features.34.bias': [4], 'features.35.weight': [4], 'features.35.bias': [4], 'features.37.weight': [4, 5], 'features.37.bias': [5], 'features.38.weight': [5], 'features.38.bias': [5], 'features.40.weight': [5], 'features.40.bias': [5], 'features.41.weight': [5], 'features.41.bias': [5], 'fc.weight': [5], 'fc.bias': [5]}
2025-06-08 08:25:06,656 [allreducer.py:972] INFO Allreducer thread started ...
2025-06-08 08:25:06,657 [main_trainer.py:130] INFO Start training ....
2025-06-08 08:25:12,805 [main_trainer.py:158] INFO Time per iteration including communication: 0.292752. computation: 0.209113. Speed: 109.307645 images/s, current density: 0.010000
2025-06-08 08:25:16,434 [main_trainer.py:158] INFO Time per iteration including communication: 0.238433. computation: 0.156406. Speed: 134.209806 images/s, current density: 0.010000
2025-06-08 08:25:18,024 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-08 08:25:18,025 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000133,0.014163,0.053891,0.001308,0.000000,0.000000
2025-06-08 08:25:20,081 [main_trainer.py:158] INFO Time per iteration including communication: 0.220035. computation: 0.138973. Speed: 145.431477 images/s, current density: 0.010000
2025-06-08 08:25:23,704 [main_trainer.py:158] INFO Time per iteration including communication: 0.210417. computation: 0.129943. Speed: 152.078744 images/s, current density: 0.010000
2025-06-08 08:25:27,064 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-08 08:25:27,064 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000374,0.013893,0.050150,0.001271,0.000000,0.000000
2025-06-08 08:25:27,238 [main_trainer.py:158] INFO Time per iteration including communication: 0.203740. computation: 0.124372. Speed: 157.063138 images/s, current density: 0.010000
2025-06-08 08:25:30,861 [main_trainer.py:158] INFO Time per iteration including communication: 0.199996. computation: 0.120735. Speed: 160.003523 images/s, current density: 0.010000
2025-06-08 08:25:34,505 [main_trainer.py:158] INFO Time per iteration including communication: 0.197466. computation: 0.117819. Speed: 162.053305 images/s, current density: 0.010000
2025-06-08 08:25:36,108 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-08 08:25:36,108 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000192,0.014058,0.050774,0.001242,0.000000,0.000000
2025-06-08 08:25:38,117 [main_trainer.py:158] INFO Time per iteration including communication: 0.195363. computation: 0.115764. Speed: 163.797641 images/s, current density: 0.010000
2025-06-08 08:25:41,752 [main_trainer.py:158] INFO Time per iteration including communication: 0.193856. computation: 0.114451. Speed: 165.071161 images/s, current density: 0.010000
2025-06-08 08:25:45,258 [allreducer.py:788] INFO [rank:%d]name[size]: backward, merge, compression, allreduce, demerge, d2h, h2d
2025-06-08 08:25:45,258 [allreducer.py:839] INFO [rank:0]total[14728266]: 0.000000,0.000273,0.013378,0.053139,0.001243,0.000000,0.000000
2025-06-08 08:25:45,434 [main_trainer.py:158] INFO Time per iteration including communication: 0.192882. computation: 0.113500. Speed: 165.904620 images/s, current density: 0.010000
